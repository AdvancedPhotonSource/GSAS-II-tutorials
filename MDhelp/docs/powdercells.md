<!--- Don't change the HTML version of this file; edit the .md version -->
<a name="PWDR_Unit_Cells_List"></a>
#  PWDR **Unit Cells List** subdata tree item (Powder Diffraction)

This tree item has several purposes, it can be used to perform autoindexing and it can be used to show the positions of peaks from unit cells which may be results from autoindexing or may be entered from a phase or manually. It can be used to refine unit cell parameters. It can also be used to search for cells/symmetry settings related to a specified unit cell & space group.

<H3 style="color:blue;font-size:1.1em">What can I do here?</H3>

The actions that can be performed with this tree item are:

1. Autoindexing
2. Visualizing reflection positions
3. Symmetry exploration
4. Cell fitting

### Autoindexing

For autoindexing, the peaks in the [Index Peak List](./powderindexppeaks.md) are used. Select one or more Bravais lattice types to use and use the "Cell Index/Refine"/"Index Cell" menu command to start indexing. Output will appear on the console and a progress bar dialog will appear which tracks trial volume. A **Cancel** button will terminate indexing for the Bravais lattice being searched; one may need to press it more than once to fully terminate the indexing process. Console output shows possible solutions with a computed **M20** for each; good solutions are indicated by high **M20** values. **X20** gives number of unindexed lines out of the 1st 20 lines and **Nc** gives total number of reflections generated for each solution.

: * **Max Nc/Nobs**: – this controls the extent of the search for the correct indexing. This may need to be increased if an indexing trial terminates too quickly. It rarely needs to be changed.
* **Start Volume**: – this sets an initial unit cell volume for the indexing. It rarely needs to be changed.
* Select "**try**" in the table to display the reflection positions the selected unit cell/space group ([as described below](#CellDisplay)).
* Select "**keep**" in the table for a cell that should be preserved when an additional indexing run is tried; all without that are erased before the indexing trial begins.

Use the "**Index Cell**" menu command to search for a unit cell that matches the peaks in the [Index Peak List](./powderindexppeaks.md) 

### Unit cell display

<a name="CellDisplay"></a>
To display a unit cell, possibly with space group extinctions, enter the unit cell here. Optionally enter space group information here as well. The values can be typed into the appropriate boxes (note that the Bravais class determines which cell parameters are available) or use the "Cell Index/Refine"/"Load Phase" menu command to read this information from a phase that has been read into a project or from a file (such as a CIF) using the "Cell Index/Refine"/"Import Cell" menu command. Note that the values in the unit cell parameter boxes can be specified as Python equations, thus entering "*2" after a value will double it and "/2" will divide it by two.

To change the displayed extinctions, first set a Bravais class, which determines the unit cell type (see [list below](#Laue_List)), and then optionally select a space group (by default the highest symmetry space group for the class is selected). As any change is made to the unit cell values or the symmetry, the display of reflection positions shown in the plot window is immediately updated. The "Show hkl positions" button also forces an update of the plot, but this is normally not needed.

Reflection positions are displayed as dashed vertical lines. Reflections will normally be shown as orange, but green lines are used instead in 3+1 superspace groups for reflections with non-zero components in the fourth dimension ("superlattice lines"). If the "Show extinct" option is selected, then reflections that are generated by the unit cell, but must be zero in intensity due to the selected space group are shown with blue dashed lines. This slows computations somewhat. Note that the speed of reflection display is determined by the number of reflections that are computed, so reducing the range of data used by changing the diffraction Limits will speed the refresh of the display when values/symmetry is changed.

The reflection indices (hkl values) can be displayed by moving the mouse cursor over a reflection line and waiting ("hovering"). After a short delay, the indices for all nearby reflections are shown temporarily as a "tool tip". If multiple reflections are closely spaced, the reflection indices will be listed in the order that reflections occur, but extinct reflections are shown after non-extinct. Also, if multiple extinct reflections occur at the same location, only the first of them is used.

### Symmetry exploration

For symmetry exploration, once a phase/cell has been loaded, the following commands in available in the "Cell Index/Refine" menu to explore related unit cells and space groups. Use the:

* The "**Load Phase**" menu command copies a selected solution to the Unit cell values;

* The "**Copy Cell**" menu command copies a selected solution to the Unit cell values; the Bravais lattice shown for the choice is copied. Press **Show hkl positions** to generate the allowed reflection positions, which are visually superimposed on the displayed powder pattern to visually confirm the indexing. Pay particular attention to any unmatched peaks in the pattern. A **Space group** can be selected from the pulldown box to remove reflections based on space group extinctions and visually eliminate possibilities. The **Try All?** button tests all compatible space groups from the pull down against the peak set. The results are displayed and one can select the “best” one based on the listed criterion.


* "Run SUBGROUPS" menu item to generate lower symmetry space groups for the loaded phase;
* "Cell Symmetry Search" menu item to find higher symmetry unit cells equivalent to the current cell.
* "Run k-SUBGROUPSMAG" menu item to find magnetic subgroups (with neutron data) commands from the
* "Transform Cell" command in that menu can perform many common lattice transformations, apply a user-supplied cell transformation or create a magnetic phase.

Note that "Run SUBGROUPS", "Cell Symmetry Search" and "Run k-SUBGROUPSMAG" access the Bilbao Crystallographic Server. If you use them please cite: Bilbao Crystallographic Server I: Databases and crystallographic computing programs, M. I. Aroyo, J. M. Perez-Mato, C. Capillas, E. Kroumova, S. Ivantchev, G. Madariaga, A. Kirov & H. Wondratschek Z. Krist. 221, 1, 15-27 (2006) ([DOI](https://doi.org/doi:10.1524/zkri.2006.221.1.15) and Determining magnetic structures in GSAS-II using the Bilbao Crystallographic Server tool k-SUBGROUPSMAG, R.B. Von Dreele & L. Elcoro, Acta Cryst. B80, x-x (2024) ([DOI](https://doi.org/10.1107/S2052520624008436). 

### Optimize a cell

To optimize a cell to fit the indexed peaks in the Index Peak List, use the "Cell Index/Refine"/"Refine Cell" menu command. The results will be placed in the Indexing Result table with 'use' selected.

### Create Phase
The "Make new phase" command creates a new phase from the selected unit cell and chosen space group. A dialog box will appear asking for a name for this phase. See the new entry under Phases and the new lattice parameters will be in the General window for that phase.

<H3 style="color:blue;font-size:1.1em">What can I do with the plot?</H3>

The plot is the largely the same as for the parent PWDR Powder Histograms tree entry 
[with the same plot actions](./powderparent.md#PWDR_plot_actions) and [same key press commands](./powderparent.md#PWDR_keylist), except that tickmarks are not shown and the obs-calc position cannot be dragged. The fit limits can be changed from the plot either here or in the Limits data tree. Change the upper and lower Tmin values by clicking on the appropriate vertical line and dragging it to the right or left. Reducing the maximum Q value (TOF min or 2θ max) can greatly speed the time needed to compute reflections from a unit cell.

<a name="Laue_List"></a>
### Visualization Laue classes

GSAS-II offers space groups in the following Laue classes when visualizing reflection positions from a unit cell. Note that symmetry classes in italics are redundant, but are included as choices for convenience:

* Cubic: Fm3m, Im3m & Pm3m
* Rhombohedral: R3-H (hexagonal axes)
* Hexagonal: P6/mmm
* Tetragonal: I4/mmm, P4/mmm
* Orthorhombic: Fmmm, Immm, Ammm, *Bmmm*, *Cmmm*, Pmmm
* Monoclinic: *I2/m*, *A2/m*, C2/m, P2/m (b-unique)
* Triclinic: P1, *C1*

